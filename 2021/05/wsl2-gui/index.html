<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="description" content="
警告此内容仅适用于Windows 10 2004(OS:19041)及以上版本，先前版本并不支持Windows Subsystem ..."><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/Yuameshi/Blog-CDN@main/background-pictures/Avatar.png" type="image/x-icon"><script src="/js/material.js" async></script><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="preload" crossorigin="crossorigin" href="https://cdn.bootcss.com/font-awesome/4.7.0/fonts/fontawesome-webfont.woff2?v=4.7.0" as="font"><link rel="preload" crossorigin="crossorigin" href="https://cdn.jsdelivr.net/npm/mdui@1.0.2/dist/icons/material-icons/MaterialIcons-Regular.woff2" as="font"><link rel="preload" crossorigin="crossorigin" href="https://cdn.jsdelivr.net/npm/mdui@1.0.2/dist/fonts/roboto/Roboto-Regular.woff2" as="font"><link rel="preload" crossorigin="crossorigin" href="https://cdn.jsdelivr.net/npm/mdui@1.0.2/dist/fonts/roboto/Roboto-Medium.woff2" as="font"><link rel="preload" crossorigin="crossorigin" href="https://cdn.jsdelivr.net/npm/mdui@1.0.2/dist/fonts/roboto/Roboto-Bold.woff2" as="font"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdui@1.0.2/dist/css/mdui.min.css?v=1.0.2"><script src="https://cdn.jsdelivr.net/npm/mdui@1.0.2/dist/js/mdui.min.js?v=1.0.2" async></script><title>给适用于Windows的Linux子系统(第二代)添加图形界面 - Yuameshiの窝</title><meta name="generator" content="Hexo 6.1.0"><link rel="alternate" href="/rss.xml" title="Yuameshiの窝" type="application/rss+xml">
</head><body class="mdui-theme-primary-indigo mdui-theme-accent-pink"><div class="appBar"><div class="mdui-appbar mdui-appbar-fixed" style="width:100vw"><div class="mdui-progress mdui-color-transparent" id="pageLoadProgressIndicator"><div class="mdui-progress-indeterminate"></div></div><div class="mdui-toolbar mdui-color-theme"><button href="javascript:;" class="mdui-btn mdui-btn-icon mdui-ripple" mdui-drawer="{target:'#left-drawer',overlay:true,swipe:true}"><i class="mdui-icon material-icons">&#xe5d2;</i></button> <a href="/" class="mdui-typo-headline">Yuameshiの窝</a><div class="mdui-toolbar-spacer"></div></div></div></div><div class="mdui-drawer mdui-color-white mdui-drawer-full-height mdui-drawer-close" id="left-drawer"><div class="drawerHeader"><div class="drawerAbout mdui-color-theme"><div class="drawerAboutMain mdui-text-color-white" style="--drawer-bg:url(https://cdn.jsdelivr.net/gh/Yuameshi/Blog-CDN@main/background-pictures/87478484_p0.webp)" data-name="Yuameshi" data-slogan="qwq"></div></div></div><nav><div class="mdui-list"><a href="/" class="mdui-list-item mdui-ripple"><i class="mdui-list-item-icon mdui-icon material-icons">&#xe88a; </i>主页 </a><a target="_blank" rel="noopener" href="https://b23.tv/CRByKN" class="mdui-list-item mdui-ripple"><i class="mdui-list-item-icon mdui-icon material-icons">&#xe04b; </i>睿站主页 </a><a href="/friends" class="mdui-list-item mdui-ripple"><i class="mdui-list-item-icon mdui-icon material-icons">&#xe7fb; </i>基友们 </a><a target="_blank" rel="noopener" href="https://github.com/Yuameshi" class="mdui-list-item mdui-ripple"><i class="mdui-list-item-icon mdui-icon material-icons">&#xe869; </i>Gay♂Hub </a><a target="_blank" rel="noopener" href="https://phicommunity.com.cn" class="mdui-list-item mdui-ripple"><i class="mdui-list-item-icon mdui-icon material-icons">&#xe149; </i>PhiCommunity </a><a href="/archives" class="mdui-list-item mdui-ripple"><i class="mdui-list-item-icon mdui-icon material-icons">&#xe149; </i>归档 </a><a href="/about" class="mdui-list-item mdui-ripple"><i class="mdui-list-item-icon mdui-icon material-icons">&#xe88e; </i>关于 </a><a target="_blank" rel="noopener" href="https://status.yuameshi.top/" class="mdui-list-item mdui-ripple"><i class="mdui-list-item-icon mdui-icon material-icons">&#xe24b; </i>憨憨の服务状态</a></div></nav></div><div class="pageTitle mdui-color-theme mdui-color-theme" style="--titleBackgroundUrl:url(https://cdn.jsdelivr.net/gh/Yuameshi/Blog-CDN@main/background-pictures/87489781_p0.webp)"><h1>给适用于Windows的Linux子系统(第二代)添加图形界面</h1></div><div class="mainContent mdui-center" id="mainContent"><div class="postPage mdui-card mdui-center"><div class="postMeta mdui-card-media"><div class="mdui-chip postDate" mdui-tooltip="{content: '发布时间'}"><span class="mdui-chip-icon"><i class="mdui-icon material-icons">&#xe192;</i> </span><span class="mdui-chip-title">2021-05-29</span></div><div class="mdui-chip postDate" mdui-tooltip="{content: '更新时间'}"><span class="mdui-chip-icon"><i class="mdui-icon material-icons">&#xe923;</i> </span><span class="mdui-chip-title">2022-04-19</span></div><div class="mdui-chip postCategories" mdui-tooltip="{content: '分类'}"><span class="mdui-chip-icon"><i class="mdui-icon material-icons">&#xe2c7;</i> </span><span class="mdui-chip-title"><a class="category-link" href="/categories/%E4%BC%AA-Server%E8%BF%90%E7%BB%B4/">伪*Server运维</a> / <a class="category-link" href="/categories/%E5%BC%80%E5%8F%91/">开发</a></span></div></div><div class="mdui-divider"></div><div class="mdui-card-content mdui-typo"><blockquote><p>警告<br><strong>此内容仅适用于Windows 10 2004(OS:19041)及以上版本，先前版本并不支持Windows Subsystem Linux 2，笔者也并未对其测试桌面体验的可行性</strong></p></blockquote><h2 id="配置系统环境"><a href="#配置系统环境" class="headerlink" title="配置系统环境"></a>配置系统环境</h2><p>要切换到第二代WSL，我们需要在<strong>权限提升的</strong>Powershell(以管理员身份运行)键入以下指令：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-comment">#安装WSL模块</span><br>dism.exe /online /<span class="hljs-built_in">enable-feature</span> /featurename:Microsoft<span class="hljs-literal">-Windows-Subsystem-Linux</span> /all /norestart<br><span class="hljs-comment">#安装虚拟机平台（WSL2特性）</span><br>dism.exe /online /<span class="hljs-built_in">enable-feature</span> /featurename:VirtualMachinePlatform /all /norestart<br></code></pre></td></tr></table></figure><p><img src="/wp-content/uploads/2021/05/image-3.png"></p><p>配置功能</p><p>在配置完成后，我们需要安装WSL2的内核更新包，<a target="_blank" rel="noopener" href="https://wslstorestorage.blob.core.windows.net/wslblob/wsl_update_x64.msi">点击下载</a>，然后安装即可。</p><p>在下载和安装的过程中，我们来进行一些简要的配置，修改内存、交换设定等，因为WSL2默认可以使用的内存大小为主机的<code>80%</code>，对于Linux而言即使装了桌面，我也就600MiB左右，分多了反而有可能卡主机的Windows。</p><p>打开Windows资源管理器，在地址栏输入 <code>%UserProfile%</code> 并回车，然后在该目录下创建一个文件, 名字为 <code>.wslconfig</code> ,写入内容示例如下，其中<code>memory</code>选项对应内存大小，<code>swap</code>对应交换大小</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">[wsl2]<br>memory=2GB<br>swap=2GB<br>localhostForwarding=true<br></code></pre></td></tr></table></figure><p><a href="https://www.yuameshi.top/wp-content/uploads/2021/05/image-4.png"><img src="/wp-content/uploads/2021/05/image-4.png"></a></p><p>.wslconfig</p><p>将以上步骤均做完后，您可以重新启动您的计算机，进行功能配置。</p><p>重新启动后，我们要将WSL 2设置为默认版本，需要在Powershell中键入<code>wsl --set-default-version 2</code></p><p>在在一切完成后，你可以到Microsoft Store安装Linux发行版，这里我采用<a target="_blank" rel="noopener" href="https://www.microsoft.com/store/productId/9N6SVWS3RX71">Ubuntu 20.04LTS</a> 。</p><p>安装完成后打开Ubuntu，他会让你进行一些基本配置，如设置用户名密码等。</p><h2 id="安装Linux图形化套件及配置"><a href="#安装Linux图形化套件及配置" class="headerlink" title="安装Linux图形化套件及配置"></a>安装Linux图形化套件及配置</h2><p>重新启动后，启动安装的WSL发行版，创建初始账户，更新包，然后安装<code>xrdp</code>、<code>dbus-x11</code>、<code>kde-full</code>(这将会占用您大约3.7GB的磁盘空间)，</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo apt update<br>sudo apt upgrade -y<br>sudo apt install xrdp kde-full dbus-x11 -y<br></code></pre></td></tr></table></figure><p>请注意，如果出现如下图所示的提示时，输入您当前账户的密码即可，在您输入任何字符后，画面不会有变化，但是实际上是输入了的。</p><p><img src="/wp-content/uploads/2021/05/image-5.png"></p><p>然后按以下代码键入：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#配置xrdp默认启动环境</span><br>sudo sed -i.bak <span class="hljs-string">&#x27;/fi/a #xrdp multiple users configuration \n startkde \n&#x27;</span> /etc/xrdp/startwm.sh<br><span class="hljs-comment">#开启端口及重启xrdp服务</span><br>sudo ufw allow 3389/tcp<br>sudo /etc/init.d/xrdp restart<br></code></pre></td></tr></table></figure><h2 id="准备连接WSL"><a href="#准备连接WSL" class="headerlink" title="准备连接WSL"></a>准备连接WSL</h2><p>在终端输入：<code>ifconfig</code>，若没有该包则使用<code>sudo apt install ifconfig -y &amp;&amp; ifconfig</code>，并记住红框内的数字（每次启动均不同）</p><p><img src="/wp-content/uploads/2021/05/image-6.png"></p><p>获取IP地址</p><p>然后在Windows下启动远程桌面客户端（按下Win+S并输入rd选择如图选项即可）</p><p><img src="/wp-content/uploads/2021/05/image-8.png"></p><p>启动远程桌面客户端</p><p>然后再客户端内键入上一步获取的IP地址，并点击”连接”</p><p>然后远程桌面客户端会提示有安全风险，直接确定即可。</p><p><img src="/wp-content/uploads/2021/05/image-9.png"></p><p>连接WSL</p><p>然后就会开启一个登陆页面，在这里输入您在WSL中的账号和密码，并单击Login。</p><p><a href="https://www.yuameshi.top/wp-content/uploads/2021/05/image-10.png"><img src="/wp-content/uploads/2021/05/image-10.png"></a></p><p>登录XRDP</p><p>然后就可以看到KDE的初始画面了。</p><p><a href="https://www.yuameshi.top/wp-content/uploads/2021/05/image-12.png"><img src="/wp-content/uploads/2021/05/image-12.png"></a></p><p>这不是初始画面（）</p></div><div class="mdui-divider"></div><div class="pageEnd"><div class="pageEndText mdui-card-actions mdui-typo">本文链接：<a href="https://www.yuameshi.top/2021/05/wsl2-gui/">https://www.yuameshi.top/2021/05/wsl2-gui/</a><br>本文采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/deed" target="_blank" rel="noopener">CC BY-NC-SA 3.0</a> 协议进行许可</div><div class="postTags"><i class="mdui-icon material-icons">&#xe54e;</i> <a class="tag-none-link" href="/tags/KDE/" rel="tag">KDE</a><a class="tag-none-link" href="/tags/Linux%E5%AD%90%E7%B3%BB%E7%BB%9F/" rel="tag">Linux子系统</a><a class="tag-none-link" href="/tags/WSL/" rel="tag">WSL</a><a class="tag-none-link" href="/tags/WSL2/" rel="tag">WSL2</a><a class="tag-none-link" href="/tags/Win10/" rel="tag">Win10</a><a class="tag-none-link" href="/tags/Windows-Subsystem-Linux/" rel="tag">Windows Subsystem Linux</a><a class="tag-none-link" href="/tags/Windows10/" rel="tag">Windows10</a><a class="tag-none-link" href="/tags/%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2/" rel="tag">图形界面</a></div><div class="nav"><a rel="prev" href="/2021/06/wuhoo/"><i class="mdui-icon material-icons">&#xe314;</i> <span>好家伙，我TM直接好家伙</span> </a><a rel="next" href="/2021/05/update-win-10-21h1/"><span>冲冲冲！更新21H1</span> <i class="mdui-icon material-icons">&#xe315;</i></a></div></div></div></div><footer class="footer"><div class="footerUpperLayer"><div class="title"><a href="https://www.yuameshi.top">Yuameshiの窝</a></div><div class="detail"><div class="text">Hello World! &nbsp;&nbsp;<div class="contact"><a target="_blank" rel="noopener" href="https://github.com/Yuameshi/"><i class="fa fa-github"></i> </a><a href="mailto:yuameshi@outlook.com"><i class="fa fa-envelope"></i> </a><a target="_blank" rel="noopener" href="https://steamcommunity.com/id/2636099143"><i class="fa fa-steam"></i> </a><a target="_blank" rel="noopener" href="https://twitter.com/HanHan_233"><i class="fa fa-twitter"></i> </a><a target="_blank" rel="noopener" href="https://t.me/yuameshi"><i class="fa fa-telegram"></i> </a><a target="_blank" rel="noopener" href="https://t.me/Yuameshi_Words"><i class="fa fa-telegram"></i></a></div></div><div class="copyrights">&copy; 2019 - 2022 Yuameshi</div></div></div><hr><div class="footerLowerLayer"><div class="left"><a href="https://hexo.io" target="_blank">由 Hexo 强力驱动</a> &nbsp;&&nbsp; <a href="https://github.com/Yuameshi/hexo-theme-mdx" target="_blank">由 MDx 主题装饰</a></div><div class="right"><a target="_blank" rel="noopener" href="https://icp.gov.moe/?keyword=20224680">萌ICP备20224680号</a></div></div></footer><button id="goToTopBtn" class="mdui-fab mdui-fab-fixed mdui-fab-hide mdui-ripple mdui-color-theme-accent" style="z-index:100"><i class="mdui-icon material-icons">&#xe316;</i></button></body></html>